<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.chart.BarChart?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.shape.SVGPath?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.text.Text?>

<AnchorPane style="-fx-background-color: #F4F6FC;" xmlns="http://javafx.com/javafx/24.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="controllers.DashboardController">
   <children>
      <!-- Sidebar -->
      <AnchorPane id="sidebar" prefWidth="250.0" style="-fx-background-color: #F4F6FC;" AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.topAnchor="0.0">
         <children>
            <!-- Logo -->
            <HBox alignment="CENTER_LEFT" layoutX="20.0" layoutY="30.0" spacing="8.0">
               <children>
                  <ImageView fitHeight="40.0" fitWidth="96.0" pickOnBounds="true" preserveRatio="true">
                     <image>
                        <Image url="@../images/logo.jpg" />
                     </image>
                  </ImageView>
               </children>
            </HBox>
            
            <!-- Navigation Menu -->
            <VBox layoutX="20.0" layoutY="100.0" spacing="8.0">
               <children>
                  <Button fx:id="dashboardBtn" alignment="CENTER_LEFT" contentDisplay="LEFT" onAction="#handleDashboard" prefHeight="42.0" prefWidth="210.0" style="-fx-background-color: #7B76F1; -fx-text-fill: white; -fx-background-radius: 8; -fx-cursor: hand; -fx-font-size: 14; -fx-padding: 0 0 0 15;" text="Dashboard">
                     <graphic>
                        <SVGPath content="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z" fill="white" />
                     </graphic>
                  </Button>
                  <Button fx:id="schoolYearsBtn" alignment="CENTER_LEFT" contentDisplay="LEFT" onAction="#handleSchoolYears" prefHeight="42.0" prefWidth="210.0" style="-fx-background-color: transparent; -fx-text-fill: #333; -fx-background-radius: 8; -fx-cursor: hand; -fx-font-size: 14; -fx-padding: 0 0 0 15;" text="School Years">
                     <graphic>
                        <SVGPath content="M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V10h14v10zm0-12H5V6h14v2z" fill="#7B76F1" />
                     </graphic>
                  </Button>
                  <Button fx:id="studentsBtn" alignment="CENTER_LEFT" contentDisplay="LEFT" onAction="#handleStudents" prefHeight="42.0" prefWidth="210.0" style="-fx-background-color: transparent; -fx-text-fill: #333; -fx-background-radius: 8; -fx-cursor: hand; -fx-font-size: 14; -fx-padding: 0 0 0 15;" text="Students">
                     <graphic>
                        <SVGPath content="M16 7c0-2.21-1.79-4-4-4S8 4.79 8 7s1.79 4 4 4 4-1.79 4-4zm-4 6c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" fill="#7B76F1" />
                     </graphic>
                  </Button>
                  <Button fx:id="payablesBtn" alignment="CENTER_LEFT" contentDisplay="LEFT" onAction="#handlePayables" prefHeight="42.0" prefWidth="210.0" style="-fx-background-color: transparent; -fx-text-fill: #333; -fx-background-radius: 8; -fx-cursor: hand; -fx-font-size: 14; -fx-padding: 0 0 0 15;" text="Payables">
                     <graphic>
                        <SVGPath content="M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z" fill="#7B76F1" />
                     </graphic>
                  </Button>
                  <Button fx:id="paymentsBtn" alignment="CENTER_LEFT" contentDisplay="LEFT" onAction="#handlePayments" prefHeight="42.0" prefWidth="210.0" style="-fx-background-color: transparent; -fx-text-fill: #333; -fx-background-radius: 8; -fx-cursor: hand; -fx-font-size: 14; -fx-padding: 0 0 0 15;" text="Payments">
                     <graphic>
                        <SVGPath content="M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 1.99 2H18c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z" fill="#7B76F1" />
                     </graphic>
                  </Button>
                  <Button fx:id="promissoryNotesBtn" alignment="CENTER_LEFT" contentDisplay="LEFT" onAction="#handlePromissoryNotes" prefHeight="42.0" prefWidth="210.0" style="-fx-background-color: transparent; -fx-text-fill: #333; -fx-background-radius: 8; -fx-cursor: hand; -fx-font-size: 14; -fx-padding: 0 0 0 15;" text="Promissory Notes">
                     <graphic>
                        <SVGPath content="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z" fill="#7B76F1" />
                     </graphic>
                  </Button>
                  <Button fx:id="reportsBtn" alignment="CENTER_LEFT" contentDisplay="LEFT" onAction="#handleReports" prefHeight="42.0" prefWidth="210.0" style="-fx-background-color: transparent; -fx-text-fill: #333; -fx-background-radius: 8; -fx-cursor: hand; -fx-font-size: 14; -fx-padding: 0 0 0 15;" text="Reports">
                     <graphic>
                        <SVGPath content="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z" fill="#7B76F1" />
                     </graphic>
                  </Button>
               </children>
            </VBox>
            
            <!-- Bottom Buttons -->
            <VBox layoutX="20.0" spacing="8.0" AnchorPane.bottomAnchor="30.0">
               <children>
                  <Button fx:id="settingsBtn" alignment="CENTER_LEFT" contentDisplay="LEFT" onAction="#handleSettings" prefHeight="42.0" prefWidth="210.0" style="-fx-background-color: transparent; -fx-text-fill: #333; -fx-background-radius: 8; -fx-cursor: hand; -fx-font-size: 14; -fx-padding: 0 0 0 15;" text="Settings">
                     <graphic>
                        <SVGPath content="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94L14.4 2.81c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.07.62-.07.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z" fill="#7B76F1" />
                     </graphic>
                  </Button>
                  <Button fx:id="logoutBtn" alignment="CENTER_LEFT" contentDisplay="LEFT" onAction="#handleLogout" prefHeight="42.0" prefWidth="210.0" style="-fx-background-color: transparent; -fx-text-fill: #FF0000; -fx-background-radius: 8; -fx-cursor: hand; -fx-font-size: 14; -fx-padding: 0 0 0 15;" text="Logout">
                     <graphic>
                        <SVGPath content="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.59L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z" fill="#FF0000" />
                     </graphic>
                  </Button>
               </children>
            </VBox>
            <Text fill="#5a0bb4" fontSmoothingType="LCD" layoutX="79.0" layoutY="59.0" strokeType="OUTSIDE" strokeWidth="0.0" text="DORPAY">
               <font>
                  <Font name="System Bold" size="24.0" />
               </font>
            </Text>
         </children>
      </AnchorPane>
      
      <!-- Main Content Area -->
      <AnchorPane style="-fx-background-color: #F4F6FC;" AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="250.0" AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="0.0">
         <children>
            <!-- Main Content Container -->
            <VBox spacing="20.0" AnchorPane.bottomAnchor="20.0" AnchorPane.leftAnchor="30.0" AnchorPane.rightAnchor="30.0" AnchorPane.topAnchor="25.0">
               <children>
                  <!-- Header with Filters -->
                  <HBox alignment="CENTER_LEFT" spacing="20.0">
                     <children>
                        <Text strokeType="OUTSIDE" strokeWidth="0.0" text="Dashboard">
                           <font>
                              <Font name="System Bold" size="28.0" />
                           </font>
                        </Text>
                        <ComboBox fx:id="yearComboBoxHeader" prefHeight="36.0" prefWidth="140.0" promptText="Select Year" style="-fx-background-color: white; -fx-border-color: #E0E0E0; -fx-border-radius: 6; -fx-background-radius: 6; -fx-border-width: 1; -fx-font-size: 12; -fx-text-fill: #333; -fx-prompt-text-fill: #999;" />
                        <HBox spacing="10.0" style="-fx-background-color: white; -fx-background-radius: 8; -fx-padding: 8 12;">
                           <children>
                              <Label style="-fx-font-size: 12;" text="Semester:" textFill="#666">
                                 <font>
                                    <Font size="12.0" />
                                 </font>
                              </Label>
                              <ComboBox fx:id="semesterComboBox" minWidth="140.0" prefHeight="32.0" prefWidth="140.0" promptText="All Semesters" style="-fx-background-color: #F8F9FA; -fx-border-color: #E0E0E0; -fx-border-radius: 6; -fx-background-radius: 6; -fx-border-width: 1; -fx-font-size: 12; -fx-text-fill: #333; -fx-prompt-text-fill: #999;" />
                           </children>
                        </HBox>
                     </children>
                  </HBox>
                  
                  <!-- Summary Cards -->
                  <HBox spacing="20.0" HBox.hgrow="ALWAYS">
                     <children>
                        <!-- Total Payments Card -->
                        <StackPane style="-fx-background-color: white; -fx-background-radius: 10; -fx-padding: 20; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 6, 0, 0, 2);" HBox.hgrow="ALWAYS">
                           <children>
                              <VBox spacing="8.0">
                                 <children>
                                    <Label text="Total payments collected" textFill="#757575">
                                       <font>
                                          <Font size="12.0" />
                                       </font>
                                    </Label>
                                    <Label fx:id="totalPaymentsLabel" text="P0.00" textFill="#333">
                                       <font>
                                          <Font name="System Bold" size="28.0" />
                                       </font>
                                    </Label>
                                    <Label fx:id="totalPaymentsSubLabel" text="Over 0 students paid" textFill="#888">
                                       <font>
                                          <Font size="11.0" />
                                       </font>
                                    </Label>
                                 </children>
                              </VBox>
                              <HBox alignment="TOP_RIGHT">
                                 <children>
                                    <Text fill="#7B76F1" strokeType="OUTSIDE" strokeWidth="0.0" style="-fx-font-size: 24;" text="ðŸ“ˆ">
                                       <font>
                                          <Font size="24.0" />
                                       </font>
                                    </Text>
                                 </children>
                              </HBox>
                           </children>
                        </StackPane>
                        
                        <!-- Total Students Card -->
                        <StackPane style="-fx-background-color: white; -fx-background-radius: 10; -fx-padding: 20; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 6, 0, 0, 2);" HBox.hgrow="ALWAYS">
                           <children>
                              <VBox spacing="8.0">
                                 <children>
                                    <Label text="Total Students" textFill="#757575">
                                       <font>
                                          <Font size="12.0" />
                                       </font>
                                    </Label>
                                    <Label fx:id="totalStudentsLabel" text="0" textFill="#333">
                                       <font>
                                          <Font name="System Bold" size="28.0" />
                                       </font>
                                    </Label>
                                    <Label text="Total Students Enrolled" textFill="#888">
                                       <font>
                                          <Font size="11.0" />
                                       </font>
                                    </Label>
                                 </children>
                              </VBox>
                              <HBox alignment="TOP_RIGHT">
                                 <children>
                                    <Text fill="#4CAF50" strokeType="OUTSIDE" strokeWidth="0.0" style="-fx-font-size: 24;" text="ðŸ“ˆ">
                                       <font>
                                          <Font size="24.0" />
                                       </font>
                                    </Text>
                                 </children>
                              </HBox>
                           </children>
                        </StackPane>
                        
                        <!-- Overdue Payments Card -->
                        <StackPane style="-fx-background-color: white; -fx-background-radius: 10; -fx-padding: 20; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 6, 0, 0, 2);" HBox.hgrow="ALWAYS">
                           <children>
                              <VBox spacing="8.0">
                                 <children>
                                    <Label text="Overdue Payments" textFill="#757575">
                                       <font>
                                          <Font size="12.0" />
                                       </font>
                                    </Label>
                                    <Label fx:id="overduePaymentsLabel" text="0" textFill="#333">
                                       <font>
                                          <Font name="System Bold" size="28.0" />
                                       </font>
                                    </Label>
                                    <Label text="Students Unpaid" textFill="#888">
                                       <font>
                                          <Font size="11.0" />
                                       </font>
                                    </Label>
                                 </children>
                              </VBox>
                              <HBox alignment="TOP_RIGHT">
                                 <children>
                                    <Text fill="#FF9800" strokeType="OUTSIDE" strokeWidth="0.0" style="-fx-font-size: 24;" text="ðŸ“ˆ">
                                       <font>
                                          <Font size="24.0" />
                                       </font>
                                    </Text>
                                 </children>
                              </HBox>
                           </children>
                        </StackPane>
                     </children>
                  </HBox>
                  
                  <!-- Charts and Tables Row -->
                  <HBox spacing="20.0" HBox.hgrow="ALWAYS" VBox.vgrow="ALWAYS">
                     <children>
                        <!-- Total Collected Payments Chart -->
                        <VBox spacing="12.0" style="-fx-background-color: white; -fx-background-radius: 10; -fx-padding: 20; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 6, 0, 0, 2);" HBox.hgrow="ALWAYS" VBox.vgrow="ALWAYS">
                           <children>
                              <Label text="Total Collected Payments" textFill="#333">
                                 <font>
                                    <Font name="System Bold" size="16.0" />
                                 </font>
                              </Label>
                              <HBox spacing="10.0">
                                 <children>
                                    <Label fx:id="chartTotalLabel" text="P0k" textFill="#333">
                                       <font>
                                          <Font name="System Bold" size="18.0" />
                                       </font>
                                    </Label>
                                    <Label fx:id="chartChangeLabel" style="-fx-font-size: 12;" text="â†‘ 0% than last month" textFill="#4CAF50">
                                       <font>
                                          <Font size="12.0" />
                                       </font>
                                    </Label>
                                 </children>
                              </HBox>
                              <!-- Legend -->
                              <HBox spacing="15.0" style="-fx-padding: 5 0;">
                                 <children>
                                    <HBox alignment="CENTER_LEFT" spacing="5.0">
                                       <children>
                                          <Text fill="#7B76F1" strokeType="OUTSIDE" strokeWidth="0.0" style="-fx-font-size: 16;" text="â€¢">
                                             <font>
                                                <Font size="16.0" />
                                             </font>
                                          </Text>
                                          <Label style="-fx-font-size: 12;" text="Paid" textFill="#666">
                                             <font>
                                                <Font size="12.0" />
                                             </font>
                                          </Label>
                                       </children>
                                    </HBox>
                                    <HBox alignment="CENTER_LEFT" spacing="5.0">
                                       <children>
                                          <Text fill="#B0BEC5" strokeType="OUTSIDE" strokeWidth="0.0" style="-fx-font-size: 16;" text="â€¢">
                                             <font>
                                                <Font size="16.0" />
                                             </font>
                                          </Text>
                                          <Label style="-fx-font-size: 12;" text="Unpaid" textFill="#666">
                                             <font>
                                                <Font size="12.0" />
                                             </font>
                                          </Label>
                                       </children>
                                    </HBox>
                                 </children>
                              </HBox>
                              <BarChart fx:id="paymentsChart" style="-fx-background-color: transparent;" VBox.vgrow="ALWAYS">
                                 <xAxis>
                                    <CategoryAxis fx:id="monthAxis" label="Month" />
                                 </xAxis>
                                 <yAxis>
                                    <NumberAxis fx:id="amountAxis" autoRanging="false" label="Amount" lowerBound="0.0" tickUnit="10000.0" upperBound="100000.0" />
                                 </yAxis>
                              </BarChart>
                           </children>
                        </VBox>
                        
                        <!-- Due Date Payments -->
                        <VBox spacing="12.0" style="-fx-background-color: white; -fx-background-radius: 10; -fx-padding: 20; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 6, 0, 0, 2);" HBox.hgrow="ALWAYS" VBox.vgrow="ALWAYS">
                           <children>
                              <Label text="Due Date Payments" textFill="#333">
                                 <font>
                                    <Font name="System Bold" size="16.0" />
                                 </font>
                              </Label>
                              <TableView fx:id="dueDatePaymentsTable" fixedCellSize="52.0" VBox.vgrow="ALWAYS">
                                 <columnResizePolicy>
                                    <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                 </columnResizePolicy>
                                 <columns>
                                    <TableColumn fx:id="dueDateNameColumn" minWidth="150.0" prefWidth="200.0" text="Name" />
                                    <TableColumn fx:id="dueDateColumn" minWidth="120.0" prefWidth="190.0" text="Due Date" />
                                 </columns>
                              </TableView>
                           </children>
                        </VBox>
                     </children>
                  </HBox>
                  
                  <!-- Latest Payments Table -->
                  <VBox spacing="12.0" style="-fx-background-color: white; -fx-background-radius: 10; -fx-padding: 20; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 6, 0, 0, 2);" VBox.vgrow="ALWAYS">
                     <children>
                        <Label text="Latest Payments" textFill="#333">
                           <font>
                              <Font name="System Bold" size="16.0" />
                           </font>
                        </Label>
                        <ScrollPane fitToWidth="true" style="-fx-background-color: transparent; -fx-border-color: transparent;" VBox.vgrow="ALWAYS">
                           <content>
                              <TableView fx:id="latestPaymentsTable" maxWidth="1.7976931348623157E308" minWidth="0.0" prefWidth="0.0" style="-fx-background-color: transparent;">
                                 <columnResizePolicy>
                                    <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                 </columnResizePolicy>
                                 <columns>
                                    <TableColumn fx:id="studentIdColumn" minWidth="100.0" text="Student ID" />
                                    <TableColumn fx:id="studentNameColumn" minWidth="150.0" text="Student name" />
                                    <TableColumn fx:id="payableAmountColumn" minWidth="120.0" text="Payable Amount" />
                                    <TableColumn fx:id="dateColumn" minWidth="120.0" text="Date" />
                                    <TableColumn fx:id="statusColumn" minWidth="100.0" text="Status" />
                                    <TableColumn fx:id="amountColumn" minWidth="100.0" text="Amount" />
                                 </columns>
                              </TableView>
                           </content>
                        </ScrollPane>
                     </children>
                  </VBox>
               </children>
            </VBox>
         </children>
      </AnchorPane>
   </children>
</AnchorPane>
